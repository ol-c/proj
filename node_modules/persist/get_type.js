var persist    = require('persist');
var files      = require('files');
var references = require('references');
var promises   = require('promises');
var modules    = require('modules');
var meta       = require('./meta');

function get_type(val) {
    if      (val === undefined       ) return 'undefined';
    else if (promises.is(val)        ) return 'promise';
    else if (persist.is(val)         ) {
        var type = meta.get(val).type;
        if (type) return type;
        //  this case only gets triggered when loading a
        //  persistant object that hasn't been assigned a
        //  type yet
        else {
            return 'persistant';
        }
    }
    else if (files.is(val)           ) return 'file';
    else if (references.is(val)      ) return 'reference';
    else if (modules.is(val)         ) return 'module';
    else if (typeof val == 'string'  ) return 'string';
    else if (typeof val == 'number'  ) return 'number';
    else if (typeof val == 'boolean' ) return 'boolean';
    else if (typeof val == 'function') return 'function';
    else if (val === null            ) return 'null';
    else if (Object.prototype.toString.call(val) == '[object Date]') return 'date';
    else return undefined;
}

module.exports = get_type;
